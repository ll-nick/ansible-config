- name: Ensure git is installed
  become: true
  tags: [never, privileged]
  ansible.builtin.package:
    name: git
    state: present

- name: Ensure config directory
  ansible.builtin.file:
    path: "{{ ansible_env.HOME }}/.config/git"
    state: directory

- name: Add gitconfig
  ansible.builtin.copy:
    src: gitconfig
    dest: "{{ ansible_env.HOME }}/.gitconfig"

- name: Add GitHub specific config
  ansible.builtin.copy:
    src: gitconfig-github.com
    dest: "{{ ansible_env.HOME }}/.config/git/gitconfig-github.com"

- name: Install delta
  ansible.builtin.shell: |
    {{ ansible_env.HOME }}/.local/bin/mise use --global delta
  args:
    creates: "{{ ansible_env.HOME }}/.local/share/mise/installs/delta"

- name: Add delta config
  ansible.builtin.copy:
    src: delta.gitconfig
    dest: "{{ ansible_env.HOME }}/.config/git/delta.gitconfig"
